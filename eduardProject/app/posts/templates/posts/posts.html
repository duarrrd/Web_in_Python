{% extends 'base.html' %}
{% from "render_field.html" import render_field %}
{% block title %}Posts List{% endblock %}
{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

<div class="container mt-4">
  <div class="row mb-4">
    <div class="col-6">
      <h1>Posts List</h1>
    </div>
    <div class="col-6 text-right">
      <a href="{{url_for('posts.add_post')}}" class="btn btn-primary">Create New Post</a>
    </div>
  </div>

  <div class="row">
    {% for post in posts %}
      {% if post.enabled or post.user.id == current_user.id %}
        <div class="col-md-6 mb-4">
          <div class="post-card">
            {% if post.image %}
              <div class="post-image" style="background-image: url('{{url_for('posts.static', filename='/' + post.image)}}')"></div>
              <div class="post-overlay">
                <div class="post-header">
                  <h2 class="post-title">{{ post.title }}</h2>
                  <span class="post-type">{{ post.type.name }}</span>
                </div>
                <h6 class="post-user">{{ post.user.username }}</h6>
                <p class="post-text">{{ post.text | truncate(150) }}</p>
                <p class="post-details">
                  <span class="post-created">{{ post.created.strftime('%Y-%m-%d %H:%M:%S') }}</span>
                  {% if not post.enabled %}
                    (disabled)
                  {% endif %}
                  <a href="{{url_for('posts.post_page', id=post.id)}}" class="btn btn-info read-post-btn">Read Post</a>
                </p>
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>

</div>

{% endblock %}
